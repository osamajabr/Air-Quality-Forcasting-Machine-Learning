# Air Quality Forecasting Model

## Overview

This project develops a forecasting model to predict air quality parameters, focusing on relative humidity using historical data. The model employs the FB Prophet algorithm, known for its efficacy in handling time series data with pronounced seasonal effects. The forecasts generated by the model extend 365 hours into the future, providing hourly predictions that offer detailed insights into the expected variations and trends in relative humidity over this period.

## Dataset Description

The dataset, [AirQualityUCI](AirQualityUCI.csv), encompasses 9358 instances of hourly measurements spanning from March 2004 to February 2005, captured by an array of five metal oxide chemical sensors located within a significantly polluted area of an Italian city. These sensors are part of an Air Quality Chemical Multisensor Device positioned at road level, making this dataset one of the longest freely available recordings of on-field deployed air quality sensor devices.

### Data Columns

- **Date**: The date of observation in DD/MM/YYYY format.
- **Time**: The time of observation in HH.MM.SS format.
- **CO(GT)**: True hourly averaged concentration of Carbon Monoxide (mg/m³).
- **PT08.S1(CO)**: Hourly averaged sensor response (tin oxide, nominally targeted at CO).
- **NMHC(GT)**: True hourly averaged concentration of Non Methane HydroCarbons (µg/m³).
- **C6H6(GT)**: True hourly averaged Benzene concentration (µg/m³).
- **PT08.S2(NMHC)**: Hourly averaged sensor response (titania, nominally NMHC targeted).
- **NOx(GT)**: True hourly averaged NOx concentration (ppb).
- **PT08.S3(NOx)**: Hourly averaged sensor response (tungsten oxide, nominally NOx targeted).
- **NO2(GT)**: True hourly averaged NO2 concentration (µg/m³).
- **PT08.S4(NO2)**: Hourly averaged sensor response (tungsten oxide, nominally NO2 targeted).
- **PT08.S5(O3)**: Hourly averaged sensor response (indium oxide, nominally O3 targeted).
- **Temperature (T)**: Temperature in degrees Celsius.
- **Relative Humidity (RH)**: Relative Humidity (%).
- **Absolute Humidity (AH)**: Absolute Humidity.

### Additional Information

- The sensors show evidence of cross-sensitivities and both concept and sensor drifts, which may affect the accuracy of concentration estimations.
- Missing values in the dataset are indicated with a value of -200. These placeholders are subsequently replaced with NaN in the preprocessing stage and are imputed with mean values of the respective columns to facilitate robust model training.
## Data Preprocessing

Key preprocessing steps include:
- Exclusion of all rows where every data point is missing.
- Conversion of the '-200' placeholder values used for missing data into NaNs. These are filled with the column mean to ensure the integrity of the dataset for robust analysis and forecasting.


## Model Description

The air quality forecasting model utilises the FB Prophet algorithm, a procedure well-suited for forecasting time series data that exhibits seasonal variations. Prophet is particularly effective due to its decomposable model framework, which includes trend, seasonality, and holidays, making it adaptable to various time series complexities with strong seasonal effects.

### Modelling Process

1. **Data Preparation**: The model begins with data preparation where the target variable 'Relative Humidity' is isolated in the 'y' column, and the corresponding timestamps are prepared in the 'ds' column. This structured data is essential for fitting the model.

2. **Model Fitting**: 
   - **Initialisation**: A Prophet model instance is created. 
   - **Fitting**: The model is then fitted to the data, where it learns from the historical patterns of relative humidity.
   - **Parameters**: During the fitting process, Prophet automatically handles any internal settings that dictate trend changes and seasonality detection.

3. **Making Future Predictions**:
   - **Future DataFrame Creation**: After training, a future dataframe is created extending 365 hours into the future, indicating the timestamps for which predictions are needed.
   - **Prediction Generation**: Prophet uses the fitted model to forecast relative humidity for each timestamp in the future dataframe.
   - **Output**: The predictions include not only the forecasted values (`yhat`) but also the uncertainty intervals (`yhat_lower`, `yhat_upper`), which provide a range of expected values.

4. **Components Breakdown**:
   - After forecasting, the model’s `plot_components` method is invoked to visualise the trend, daily and weekly seasonality. This breakdown helps in understanding which factors (time of day, day of the week) are most influential in predicting relative humidity.

### Visualisation of Forecast
- The `plot` function of Prophet is used to draw the forecast along with the historical data, giving a clear visual representation of how well the model predicts future values. This plot helps in quickly identifying any discrepancies between the predicted and actual values and understanding the model’s performance over time.


## Model Results and Graph Explanations

### Forecast Plot

![Predictive Model Forecast of Relative Humidity Over Time](assets/Predictive%20Model%20Forecast%20of%20Relative%20Humidity%20Over%20Time.png)

- **Black dots**: Observed values of relative humidity over time.
- **Blue line**: Predicted trend line showing forecasted relative humidity values.
- **Blue shaded area**: Uncertainty interval of the predictions.

The forecast plot suggests the model captures seasonal patterns well, although actual measurements occasionally deviate significantly from predictions, possibly due to unexpected weather changes or sensor anomalies.

### Components Plot

![Components of Relative Humidity Forecast](assets/Components%20of%20Relative%20Humidity%20Forecast.png)


- **Trend**: Shows the overall increase or decrease in relative humidity over the period.
- **Weekly**: Reveals higher relative humidity mid-week and lower towards the weekends.
- **Daily**: Indicates peak relative humidity in the early morning hours, decreasing towards midday.

These components help understand how different timescales contribute to changes in relative humidity, providing insights into daily and weekly environmental dynamics.
